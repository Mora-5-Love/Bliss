#include "ntt_harvey.h"

/*
  Compute NTT using Shoup's method.

  wtab = table of roots of unity. If w = primitive PARAM_N-th root, then the
  table
  is:
   1, w,   w^2, ..., w^{PARAM_N/2-1},
   1, w^2, w^4, ..., w^{PARAM_N/2-2},
   1, w^4, w^8, ..., w^{PARAM_N/2-4}
   ...
   1, w^{PARAM_N/8}, w^{PARAM_N/4}, w^{3*PARAM_N/8},
   1, w^{PARAM_N/4},
   1.
  wtab_shoup[i] = floor(2^16 * wtab[i] / p) for each wtab[i]
*/
void ntt_harvey(uint16_t* x, const uint16_t* wtab, const uint16_t* wtab_shoup) {
  size_t M = 1;
  for (size_t N = PARAM_N; N > 4; N /= 2, M *= 2) {
    uint16_t* x0 = x;
    uint16_t* x1 = x + N / 2;
    for (size_t r = 0; r < M; r++, x0 += N, x1 += N) {
      for (int i = N / 2 - 2; i >= 0; i -= 2) {
        // odd pair
        {
          uint16_t u0 = x0[i + 1];
          uint16_t u1 = x1[i + 1];

          uint16_t t0 = u0 + u1;
          t0 -= ((t0 >= PARAM_Q) ? PARAM_Q : 0);

          uint16_t t1 = u0 - u1;
          t1 += (((int16_t)t1 < 0) ? PARAM_Q : 0);

          uint16_t q = ((uint32_t)t1 * wtab_shoup[i + 1]) >> 16;
          uint16_t t2 = t1 * wtab[i + 1] - q * PARAM_Q;
          t2 -= ((t2 >= PARAM_Q) ? PARAM_Q : 0);

          x0[i + 1] = t0;
          x1[i + 1] = t2;
        }
        // even pair
        {
          uint16_t u0 = x0[i];
          uint16_t u1 = x1[i];

          uint16_t t0 = u0 + u1;
          t0 -= ((t0 >= PARAM_Q) ? PARAM_Q : 0);

          uint16_t t1 = u0 - u1;
          t1 += (((int16_t)t1 < 0) ? PARAM_Q : 0);

          uint16_t q = ((uint32_t)t1 * wtab_shoup[i]) >> 16;
          uint16_t t2 = t1 * wtab[i] - q * PARAM_Q;
          t2 -= ((t2 >= PARAM_Q) ? PARAM_Q : 0);

          x0[i] = t0;
          x1[i] = t2;
        }
      }
    }
    wtab += N / 2;
    wtab_shoup += N / 2;
  }

  // last two layers
  for (size_t r = 0; r < M; r++, x += 4) {
    uint16_t u0 = x[0];
    uint16_t u1 = x[1];
    uint16_t u2 = x[2];
    uint16_t u3 = x[3];

    uint16_t v0 = u0 + u2;
    v0 -= (v0 >= PARAM_Q) ? PARAM_Q : 0;
    uint16_t v2 = u0 - u2;
    v2 += ((int16_t)v2 < 0) ? PARAM_Q : 0;

    uint16_t v1 = u1 + u3;
    v1 -= (v1 >= PARAM_Q) ? PARAM_Q : 0;
    uint16_t t = u1 - u3;
    t += ((int16_t)t < 0) ? PARAM_Q : 0;

    uint16_t q = ((uint32_t)t * wtab_shoup[1]) >> 16;
    uint16_t v3 = t * wtab[1] - q * PARAM_Q;
    v3 -= (v3 >= PARAM_Q) ? PARAM_Q : 0;

    uint16_t z0 = v0 + v1;
    z0 -= (z0 >= PARAM_Q) ? PARAM_Q : 0;
    uint16_t z1 = v0 - v1;
    z1 += ((int16_t)z1 < 0) ? PARAM_Q : 0;

    uint16_t z2 = v2 + v3;
    z2 -= (z2 >= PARAM_Q) ? PARAM_Q : 0;
    uint16_t z3 = v2 - v3;
    z3 += ((int16_t)z3 < 0) ? PARAM_Q : 0;

    x[0] = z0;
    x[1] = z1;
    x[2] = z2;
    x[3] = z3;
  }
}

/*
Helper functions
*/

void mul_pointwise_shoup(uint16_t* c, const uint16_t* a, const uint16_t* b,
                         const uint16_t* b_shoup) {
  size_t i;
  uint16_t q;
  for (i = 0; i < PARAM_N; i++) {
    q = ((uint32_t)a[i] * b_shoup[i]) >> 16;
    c[i] = a[i] * b[i] - q * PARAM_Q;
    c[i] -= (c[i] >= PARAM_Q) ? PARAM_Q : 0;
  }
}

/* Constants */
const uint16_t harvey_omegas[1023] = {
    1,     49,    2401,  7048,  1260,  295,   2166,  7822,  2319,  3030,  1002,
    12231, 9447,  8210,  9042,  654,   7468,  9551,  1017,  677,   8595,  3329,
    3364,  5079,  3091,  3991,  11224, 9260,  11336, 2459,  9890,  5339,  3542,
    1512,  354,   5057,  2013,  325,   3636,  6118,  4846,  3963,  9852,  3477,
    10616, 4046,  1630,  6136,  5728,  10314, 1537,  1579,  3637,  6167,  7247,
    11011, 11112, 3772,  493,   11868, 3949,  9166,  6730,  10256, 10984, 9789,
    390,   6821,  2426,  8273,  12129, 4449,  9088,  2908,  7313,  1956,  9821,
    1958,  9919,  6760,  11726, 9280,  27,    1323,  3382,  5961,  9442,  7965,
    9326,  2281,  1168,  8076,  2476,  10723, 9289,  468,   10643, 5369,  5012,
    12097, 2881,  5990,  10863, 3860,  4805,  1954,  9723,  9445,  8112,  4240,
    11136, 4948,  8961,  8974,  9611,  3957,  9558,  1360,  5195,  8775,  12149,
    5429,  7952,  8689,  7935,  7856,  3985,  10930, 7143,  5915,  7188,  8120,
    4632,  5766,  12176, 6752,  11334, 2361,  5088,  3532,  1022,  922,   8311,
    1702,  9664,  6554,  1632,  6234,  10530, 12121, 4057,  2169,  7969,  9522,
    11885, 4782,  827,   3656,  7098,  3710,  9744,  10474, 9377,  4780,  729,
    11143, 5291,  1190,  9154,  6142,  6022,  142,   6958,  9139,  5407,  6874,
    5023,  347,   4714,  9784,  145,   7105,  4053,  1973,  10654, 5908,  6845,
    3602,  4452,  9235,  10111, 3879,  5736,  10706, 8456,  8807,  1428,  8527,
    12286, 12142, 5086,  3434,  8509,  11404, 5791,  1112,  5332,  3199,  9283,
    174,   8526,  12237, 9741,  10327, 2174,  8214,  9238,  10258, 11082, 2302,
    2197,  9341,  3016,  316,   3195,  9087,  2859,  4912,  7197,  8561,  1663,
    7753,  11227, 9407,  6250,  11314, 1381,  6224,  10040, 400,   7311,  1858,
    5019,  151,   7399,  6170,  7394,  5925,  7678,  7552,  1378,  6077,  2837,
    3834,  3531,  973,   10810, 1263,  442,   9369,  4388,  6099,  3915,  7500,
    11119, 4115,  5011,  12048, 480,   11231, 9603,  3565,  2639,  6421,  7404,
    6415,  7110,  4298,  1689,  9027,  12208, 8320,  2143,  6695,  8541,  683,
    8889,  5446,  8785,  350,   4861,  4698,  9000,  10885, 4938,  8471,  9542,
    576,   3646,  6608,  4278,  709,   10163, 6427,  7698,  8532,  242,   11858,
    3459,  9734,  9984,  9945,  8034,  418,   8193,  8209,  8993,  10542, 420,
    8291,  722,   10800, 773,   1010,  334,   4077,  3149,  6833,  3014,  218,
    10682, 7280,  339,   4322,  2865,  5206,  9314,  1693,  9223,  9523,  11934,
    7183,  7875,  4916,  7393,  5876,  5277,  504,   118,   5782,  671,   8301,
    1212,  10232, 9808,  1321,  3284,  1159,  7635,  5445,  8736,  10238, 10102,
    3438,  8705,  8719,  9405,  6152,  6512,  11863, 3704,  9450,  8357,  3956,
    9509,  11248, 10436, 7515,  11854, 3263,  130,   6370,  4905,  6854,  4043,
    1483,  11222, 9162,  6534,  652,   7370,  4749,  11499, 10446, 8005,  11286,
    9,     441,   9320,  1987,  11340, 2655,  7205,  8953,  8582,  2692,  9018,
    11767, 11289, 156,   7644,  5886,  5767,  12225, 9153,  6093,  3621,  5383,
    5698,  8844,  3241,  11341, 2704,  9606,  3712,  9842,  2987,  11184, 7300,
    1319,  3186,  8646,  5828,  2925,  8146,  5906,  6747,  11089, 2645,  6715,
    9521,  11836, 2381,  6068,  2396,  6803,  1544,  1922,  8155,  6347,  3778,
    787,   1696,  9370,  4437,  8500,  10963, 8760,  11414, 6281,  544,   2078,
    3510,  12233, 9545,  723,   10849, 3174,  8058,  1594,  4372,  5315,  2366,
    5333,  3248,  11684, 7222,  9786,  243,   11907, 5860,  4493,  11244, 10240,
    10200, 8240,  10512, 11239, 9995,  10484, 9867,  4212,  9764,  11454, 8241,
    10561, 1351,  4754,  11744, 10162, 6378,  5297,  1484,  11271, 11563, 1293,
    1912,  7665,  6915,  7032,  476,   11035, 1,     2401,  1260,  2166,  2319,
    1002,  9447,  9042,  7468,  1017,  8595,  3364,  3091,  11224, 11336, 9890,
    3542,  354,   2013,  3636,  4846,  9852,  10616, 1630,  5728,  1537,  3637,
    7247,  11112, 493,   3949,  6730,  10984, 390,   2426,  12129, 9088,  7313,
    9821,  9919,  11726, 27,    3382,  9442,  9326,  1168,  2476,  9289,  10643,
    5012,  2881,  10863, 4805,  9723,  8112,  11136, 8961,  9611,  9558,  5195,
    12149, 7952,  7935,  3985,  7143,  7188,  4632,  12176, 11334, 5088,  1022,
    8311,  9664,  1632,  10530, 4057,  7969,  11885, 827,   7098,  9744,  9377,
    729,   5291,  9154,  6022,  6958,  5407,  5023,  4714,  145,   4053,  10654,
    6845,  4452,  10111, 5736,  8456,  1428,  12286, 5086,  8509,  5791,  5332,
    9283,  8526,  9741,  2174,  9238,  11082, 2197,  3016,  3195,  2859,  7197,
    1663,  11227, 6250,  1381,  10040, 7311,  5019,  7399,  7394,  7678,  1378,
    2837,  3531,  10810, 442,   4388,  3915,  11119, 5011,  480,   9603,  2639,
    7404,  7110,  1689,  12208, 2143,  8541,  8889,  8785,  4861,  9000,  4938,
    9542,  3646,  4278,  10163, 7698,  242,   3459,  9984,  8034,  8193,  8993,
    420,   722,   773,   334,   3149,  3014,  10682, 339,   2865,  9314,  9223,
    11934, 7875,  7393,  5277,  118,   671,   1212,  9808,  3284,  7635,  8736,
    10102, 8705,  9405,  6512,  3704,  8357,  9509,  10436, 11854, 130,   4905,
    4043,  11222, 6534,  7370,  11499, 8005,  9,     9320,  11340, 7205,  8582,
    9018,  11289, 7644,  5767,  9153,  3621,  5698,  3241,  2704,  3712,  2987,
    7300,  3186,  5828,  8146,  6747,  2645,  9521,  2381,  2396,  1544,  8155,
    3778,  1696,  4437,  10963, 11414, 544,   3510,  9545,  10849, 8058,  4372,
    2366,  3248,  7222,  243,   5860,  11244, 10200, 10512, 9995,  9867,  9764,
    8241,  1351,  11744, 6378,  1484,  11563, 1912,  6915,  476,   1,     1260,
    2319,  9447,  7468,  8595,  3091,  11336, 3542,  2013,  4846,  10616, 5728,
    3637,  11112, 3949,  10984, 2426,  9088,  9821,  11726, 3382,  9326,  2476,
    10643, 2881,  4805,  8112,  8961,  9558,  12149, 7935,  7143,  4632,  11334,
    1022,  9664,  10530, 7969,  827,   9744,  729,   9154,  6958,  5023,  145,
    10654, 4452,  5736,  1428,  5086,  5791,  9283,  9741,  9238,  2197,  3195,
    7197,  11227, 1381,  7311,  7399,  7678,  2837,  10810, 4388,  11119, 480,
    2639,  7110,  12208, 8541,  8785,  9000,  9542,  4278,  7698,  3459,  8034,
    8993,  722,   334,   3014,  339,   9314,  11934, 7393,  118,   1212,  3284,
    8736,  8705,  6512,  8357,  10436, 130,   4043,  6534,  11499, 9,     11340,
    8582,  11289, 5767,  3621,  3241,  3712,  7300,  5828,  6747,  9521,  2396,
    8155,  1696,  10963, 544,   9545,  8058,  2366,  7222,  5860,  10200, 9995,
    9764,  1351,  6378,  11563, 6915,  1,     2319,  7468,  3091,  3542,  4846,
    5728,  11112, 10984, 9088,  11726, 9326,  10643, 4805,  8961,  12149, 7143,
    11334, 9664,  7969,  9744,  9154,  5023,  10654, 5736,  5086,  9283,  9238,
    3195,  11227, 7311,  7678,  10810, 11119, 2639,  12208, 8785,  9542,  7698,
    8034,  722,   3014,  9314,  7393,  1212,  8736,  6512,  10436, 4043,  11499,
    11340, 11289, 3621,  3712,  5828,  9521,  8155,  10963, 9545,  2366,  5860,
    9995,  1351,  11563, 1,     7468,  3542,  5728,  10984, 11726, 10643, 8961,
    7143,  9664,  9744,  5023,  5736,  9283,  3195,  7311,  10810, 2639,  8785,
    7698,  722,   9314,  1212,  6512,  4043,  11340, 3621,  5828,  8155,  9545,
    5860,  1351,  1,     3542,  10984, 10643, 7143,  9744,  5736,  3195,  10810,
    8785,  722,   1212,  4043,  3621,  8155,  5860,  1,     10984, 7143,  5736,
    10810, 722,   4043,  8155,  1,     7143,  10810, 4043,  1,     10810, 1};

const uint16_t harvey_omegas_shoup[1023] = {
    5,     261,   12804, 37586, 6719,  1573,  11551, 41713, 12366, 16158, 5343,
    65226, 50379, 43783, 48220, 3487,  39826, 50934, 5423,  3610,  45836, 17753,
    17939, 27085, 16483, 21283, 59856, 49382, 60453, 13113, 52742, 28472, 18889,
    8063,  1887,  26968, 10735, 1733,  19390, 32626, 25843, 21134, 52539, 18542,
    56614, 21576, 8692,  32722, 30546, 55003, 8196,  8420,  19395, 32887, 38647,
    58720, 59259, 20115, 2629,  63290, 21059, 48881, 35890, 54694, 58576, 52203,
    2079,  36375, 12937, 44119, 64682, 23726, 48465, 15508, 38999, 10431, 52374,
    10441, 52897, 36050, 62533, 49489, 143,   7055,  18035, 31789, 50353, 42476,
    49734, 12164, 6228,  43068, 13204, 57184, 49537, 2495,  56758, 28632, 26728,
    64512, 15364, 31944, 57931, 20584, 25624, 10420, 51851, 50369, 43260, 22611,
    59387, 26387, 47788, 47857, 51254, 21102, 50971, 7252,  27704, 46796, 64789,
    28952, 42407, 46337, 42316, 41895, 21251, 58288, 38092, 31544, 38332, 43303,
    24701, 30749, 64933, 36007, 60443, 12590, 27133, 18835, 5450,  4916,  44321,
    9076,  51537, 34951, 8703,  33245, 56155, 64640, 21635, 11567, 42497, 50779,
    63381, 25501, 4410,  19497, 37852, 19785, 51963, 55856, 50006, 25491, 3887,
    59424, 28216, 6346,  48817, 32754, 32114, 757,   37106, 48737, 28834, 36658,
    26787, 1850,  25139, 52177, 773,   37890, 21614, 10521, 56816, 31506, 36503,
    19209, 23742, 49249, 53920, 20686, 30589, 57094, 45094, 46966, 7615,  45473,
    65520, 64752, 27123, 18313, 45377, 60816, 30882, 5930,  28435, 17059, 49505,
    927,   45468, 65258, 51947, 55072, 11593, 43804, 49265, 54704, 59099, 12276,
    11716, 49814, 16084, 1685,  17038, 48460, 15246, 26195, 38380, 45654, 8868,
    41345, 59872, 50166, 33330, 60336, 7364,  33191, 53542, 2133,  38988, 9908,
    26765, 805,   39458, 32903, 39431, 31597, 40946, 40274, 7348,  32408, 15129,
    20446, 18830, 5188,  57648, 6735,  2357,  49963, 23400, 32525, 20878, 39996,
    59296, 21944, 26723, 64250, 2559,  59893, 51211, 19011, 14073, 34242, 39484,
    34210, 37916, 22920, 9007,  48140, 65104, 44369, 11428, 35703, 45548, 3642,
    47404, 29042, 46849, 1866,  25923, 25053, 47996, 58048, 26333, 45174, 50886,
    3071,  19443, 35239, 22814, 3781,  54198, 34274, 41052, 45500, 1290,  63237,
    18446, 51910, 53243, 53035, 42844, 2229,  43692, 43777, 47958, 56219, 2239,
    44215, 3850,  57595, 4122,  5386,  1781,  21742, 16793, 36439, 16073, 1162,
    56966, 38823, 1807,  23048, 15278, 27763, 49670, 9028,  49185, 50785, 63642,
    38306, 41996, 26216, 39426, 31336, 28141, 2687,  629,   30834, 3578,  44268,
    6463,  54566, 52305, 7044,  17513, 6180,  40716, 29037, 46588, 54598, 53872,
    18334, 46422, 46497, 50155, 32807, 34727, 63264, 19753, 50395, 44567, 21096,
    50710, 59984, 55654, 40076, 63216, 17401, 693,   33970, 26157, 36551, 21560,
    7908,  59845, 48860, 34845, 3477,  39303, 25325, 61323, 55707, 42689, 60187,
    47,    2351,  49702, 10596, 60475, 14158, 38423, 47745, 45766, 14356, 48092,
    62752, 60203, 831,   40764, 31389, 30754, 65194, 48812, 32493, 19310, 28706,
    30386, 47164, 17283, 60480, 14420, 51227, 19795, 52486, 15929, 59643, 38930,
    7034,  16990, 46108, 31080, 15598, 43441, 31496, 35981, 59136, 14105, 35810,
    50774, 63120, 12697, 32360, 12777, 36279, 8233,  10249, 43489, 33847, 20147,
    4196,  9044,  49969, 23662, 45329, 58464, 46716, 60869, 33495, 2901,  11081,
    18718, 65237, 50902, 3855,  57856, 16926, 42972, 8500,  23315, 28344, 12617,
    28440, 17321, 62309, 38514, 52187, 1295,  63498, 31250, 23960, 59963, 54608,
    54395, 43943, 56059, 59936, 53302, 55910, 52619, 22462, 52070, 61083, 43948,
    56320, 7204,  25352, 62629, 54192, 34013, 28248, 7914,  60107, 61664, 6895,
    10196, 40876, 36876, 37500, 2538,  58848, 5,     12804, 6719,  11551, 12366,
    5343,  50379, 48220, 39826, 5423,  45836, 17939, 16483, 59856, 60453, 52742,
    18889, 1887,  10735, 19390, 25843, 52539, 56614, 8692,  30546, 8196,  19395,
    38647, 59259, 2629,  21059, 35890, 58576, 2079,  12937, 64682, 48465, 38999,
    52374, 52897, 62533, 143,   18035, 50353, 49734, 6228,  13204, 49537, 56758,
    26728, 15364, 57931, 25624, 51851, 43260, 59387, 47788, 51254, 50971, 27704,
    64789, 42407, 42316, 21251, 38092, 38332, 24701, 64933, 60443, 27133, 5450,
    44321, 51537, 8703,  56155, 21635, 42497, 63381, 4410,  37852, 51963, 50006,
    3887,  28216, 48817, 32114, 37106, 28834, 26787, 25139, 773,   21614, 56816,
    36503, 23742, 53920, 30589, 45094, 7615,  65520, 27123, 45377, 30882, 28435,
    49505, 45468, 51947, 11593, 49265, 59099, 11716, 16084, 17038, 15246, 38380,
    8868,  59872, 33330, 7364,  53542, 38988, 26765, 39458, 39431, 40946, 7348,
    15129, 18830, 57648, 2357,  23400, 20878, 59296, 26723, 2559,  51211, 14073,
    39484, 37916, 9007,  65104, 11428, 45548, 47404, 46849, 25923, 47996, 26333,
    50886, 19443, 22814, 54198, 41052, 1290,  18446, 53243, 42844, 43692, 47958,
    2239,  3850,  4122,  1781,  16793, 16073, 56966, 1807,  15278, 49670, 49185,
    63642, 41996, 39426, 28141, 629,   3578,  6463,  52305, 17513, 40716, 46588,
    53872, 46422, 50155, 34727, 19753, 44567, 50710, 55654, 63216, 693,   26157,
    21560, 59845, 34845, 39303, 61323, 42689, 47,    49702, 60475, 38423, 45766,
    48092, 60203, 40764, 30754, 48812, 19310, 30386, 17283, 14420, 19795, 15929,
    38930, 16990, 31080, 43441, 35981, 14105, 50774, 12697, 12777, 8233,  43489,
    20147, 9044,  23662, 58464, 60869, 2901,  18718, 50902, 57856, 42972, 23315,
    12617, 17321, 38514, 1295,  31250, 59963, 54395, 56059, 53302, 52619, 52070,
    43948, 7204,  62629, 34013, 7914,  61664, 10196, 36876, 2538,  5,     6719,
    12366, 50379, 39826, 45836, 16483, 60453, 18889, 10735, 25843, 56614, 30546,
    19395, 59259, 21059, 58576, 12937, 48465, 52374, 62533, 18035, 49734, 13204,
    56758, 15364, 25624, 43260, 47788, 50971, 64789, 42316, 38092, 24701, 60443,
    5450,  51537, 56155, 42497, 4410,  51963, 3887,  48817, 37106, 26787, 773,
    56816, 23742, 30589, 7615,  27123, 30882, 49505, 51947, 49265, 11716, 17038,
    38380, 59872, 7364,  38988, 39458, 40946, 15129, 57648, 23400, 59296, 2559,
    14073, 37916, 65104, 45548, 46849, 47996, 50886, 22814, 41052, 18446, 42844,
    47958, 3850,  1781,  16073, 1807,  49670, 63642, 39426, 629,   6463,  17513,
    46588, 46422, 34727, 44567, 55654, 693,   21560, 34845, 61323, 47,    60475,
    45766, 60203, 30754, 19310, 17283, 19795, 38930, 31080, 35981, 50774, 12777,
    43489, 9044,  58464, 2901,  50902, 42972, 12617, 38514, 31250, 54395, 53302,
    52070, 7204,  34013, 61664, 36876, 5,     12366, 39826, 16483, 18889, 25843,
    30546, 59259, 58576, 48465, 62533, 49734, 56758, 25624, 47788, 64789, 38092,
    60443, 51537, 42497, 51963, 48817, 26787, 56816, 30589, 27123, 49505, 49265,
    17038, 59872, 38988, 40946, 57648, 59296, 14073, 65104, 46849, 50886, 41052,
    42844, 3850,  16073, 49670, 39426, 6463,  46588, 34727, 55654, 21560, 61323,
    60475, 60203, 19310, 19795, 31080, 50774, 43489, 58464, 50902, 12617, 31250,
    53302, 7204,  61664, 5,     39826, 18889, 30546, 58576, 62533, 56758, 47788,
    38092, 51537, 51963, 26787, 30589, 49505, 17038, 38988, 57648, 14073, 46849,
    41052, 3850,  49670, 6463,  34727, 21560, 60475, 19310, 31080, 43489, 50902,
    31250, 7204,  5,     18889, 58576, 56758, 38092, 51963, 30589, 17038, 57648,
    46849, 3850,  6463,  21560, 19310, 43489, 31250, 5,     58576, 38092, 30589,
    57648, 3850,  21560, 43489, 5,     38092, 57648, 21560, 5,     57648, 5};

const uint16_t harvey_omegas_inv[1023] = {
    1,     1254,  11813, 5257,  5374,  4624,  10377, 10996, 726,   1018,  10805,
    6992,  5911,  2127,  545,   7535,  10938, 1728,  4048,  835,   2525,  8077,
    2422,  1805,  2294,  1050,  1777,  4049,  2089,  2049,  1045,  7796,  6429,
    382,   12046, 2503,  5067,  605,   9041,  6956,  9923,  6974,  7917,  10695,
    4231,  9115,  1440,  11566, 2744,  56,    8779,  10211, 11745, 6008,  875,
    3529,  1326,  3789,  7852,  2919,  10593, 11502, 8511,  5942,  4134,  10367,
    10745, 5486,  9893,  6221,  9908,  453,   2768,  5574,  9644,  1200,  5542,
    6383,  4143,  9364,  6461,  3643,  9103,  10970, 4989,  1105,  9302,  2447,
    8577,  2683,  9585,  948,   9048,  3445,  6591,  6906,  8668,  6196,  3136,
    64,    6522,  6403,  4645,  12133, 1000,  522,   3271,  9597,  3707,  3336,
    5084,  9634,  949,   10302, 2969,  11848, 12280, 1003,  4284,  1843,  790,
    7540,  4919,  11637, 5755,  3127,  1067,  10806, 8246,  5435,  7384,  5919,
    12159, 9026,  435,   4774,  1853,  1041,  2780,  8333,  3932,  2839,  8585,
    426,   5777,  6137,  2884,  3570,  3584,  8851,  2187,  2051,  3553,  6844,
    4654,  11130, 9005,  10968, 2481,  2057,  11077, 3988,  11618, 6507,  12171,
    11785, 7012,  6413,  4896,  7373,  4414,  5106,  355,   2766,  3066,  10596,
    2975,  7083,  9424,  7967,  11950, 5009,  1607,  12071, 9275,  5456,  9140,
    8212,  11955, 11279, 11516, 1489,  11567, 3998,  11869, 1747,  3296,  4080,
    4096,  11871, 4255,  2344,  2305,  2555,  8830,  431,   12047, 3757,  4591,
    5862,  2126,  11580, 8011,  5681,  8643,  11713, 2747,  3818,  7351,  1404,
    3289,  7591,  7428,  11939, 3504,  6843,  3400,  11606, 3748,  5594,  10146,
    3969,  81,    3262,  10600, 7991,  5179,  5874,  4885,  5868,  9650,  8724,
    2686,  1058,  11809, 241,   7278,  8174,  1170,  4789,  8374,  6190,  7901,
    2920,  11847, 11026, 1479,  11316, 8758,  8455,  9452,  6212,  10911, 4737,
    4611,  6364,  4895,  6119,  4890,  12138, 7270,  10431, 4978,  11889, 2249,
    6065,  10908, 975,   6039,  2882,  1062,  4536,  10626, 3728,  5092,  7377,
    9430,  3202,  9094,  11973, 9273,  2948,  10092, 9987,  1207,  2031,  3051,
    4075,  10115, 1962,  2548,  52,    3763,  12115, 3006,  9090,  6957,  11177,
    6498,  885,   3780,  8855,  7203,  147,   3,     3762,  10861, 3482,  3833,
    1583,  6553,  8410,  2178,  3054,  7837,  8687,  5444,  6381,  1635,  10316,
    8236,  5184,  12144, 2505,  7575,  11942, 7266,  5415,  6882,  3150,  5331,
    12147, 6267,  6147,  3135,  11099, 6998,  1146,  11560, 7509,  2912,  1815,
    2545,  8579,  5191,  8633,  11462, 7507,  404,   2767,  4320,  10120, 8232,
    168,   1759,  6055,  10657, 5735,  2625,  10587, 3978,  11367, 11267, 8757,
    7201,  9928,  955,   5537,  113,   6523,  7657,  4169,  5101,  6374,  5146,
    1359,  8304,  4433,  4354,  3600,  4337,  6860,  140,   3514,  7094,  10929,
    2731,  8332,  2678,  3315,  3328,  7341,  1153,  8049,  4177,  2844,  2566,
    10335, 7484,  8429,  1426,  6299,  9408,  192,   7277,  6920,  1646,  11821,
    3000,  1566,  9813,  4213,  11121, 10008, 2963,  4324,  2847,  6328,  8907,
    10966, 12262, 3009,  563,   5529,  2370,  10331, 2468,  10333, 4976,  9381,
    3201,  7840,  160,   4016,  9863,  5468,  11899, 2500,  1305,  2033,  5559,
    3123,  8340,  421,   11796, 8517,  1177,  1278,  5042,  6122,  8652,  10710,
    10752, 1975,  6561,  6153,  10659, 8243,  1673,  8812,  2437,  8326,  7443,
    6171,  8653,  11964, 10276, 7232,  11935, 10777, 8747,  6950,  2399,  9830,
    953,   3029,  1065,  8298,  9198,  7210,  8925,  8960,  3694,  11612, 11272,
    2738,  4821,  11635, 3247,  4079,  2842,  58,    11287, 9259,  9970,  4467,
    10123, 11994, 11029, 5241,  9888,  12240, 1,     11813, 5374,  10377, 726,
    10805, 5911,  545,   10938, 4048,  2525,  2422,  2294,  1777,  2089,  1045,
    6429,  12046, 5067,  9041,  9923,  7917,  4231,  1440,  2744,  8779,  11745,
    875,   1326,  7852,  10593, 8511,  4134,  10745, 9893,  9908,  2768,  9644,
    5542,  4143,  6461,  9103,  4989,  9302,  8577,  9585,  9048,  6591,  8668,
    3136,  6522,  4645,  1000,  3271,  3707,  5084,  949,   2969,  12280, 4284,
    790,   4919,  5755,  1067,  8246,  7384,  12159, 435,   1853,  2780,  3932,
    8585,  5777,  2884,  3584,  2187,  3553,  4654,  9005,  2481,  11077, 11618,
    12171, 7012,  4896,  4414,  355,   3066,  2975,  9424,  11950, 1607,  9275,
    9140,  11955, 11516, 11567, 11869, 3296,  4096,  4255,  2305,  8830,  12047,
    4591,  2126,  8011,  8643,  2747,  7351,  3289,  7428,  3504,  3400,  3748,
    10146, 81,    10600, 5179,  4885,  9650,  2686,  11809, 7278,  1170,  8374,
    7901,  11847, 1479,  8758,  9452,  10911, 4611,  4895,  4890,  7270,  4978,
    2249,  10908, 6039,  1062,  10626, 5092,  9430,  9094,  9273,  10092, 1207,
    3051,  10115, 2548,  3763,  3006,  6957,  6498,  3780,  7203,  3,     10861,
    3833,  6553,  2178,  7837,  5444,  1635,  8236,  12144, 7575,  7266,  6882,
    5331,  6267,  3135,  6998,  11560, 2912,  2545,  5191,  11462, 404,   4320,
    8232,  1759,  10657, 2625,  3978,  11267, 7201,  955,   113,   7657,  5101,
    5146,  8304,  4354,  4337,  140,   7094,  2731,  2678,  3328,  1153,  4177,
    2566,  7484,  1426,  9408,  7277,  1646,  3000,  9813,  11121, 2963,  2847,
    8907,  12262, 563,   2370,  2468,  4976,  3201,  160,   9863,  11899, 1305,
    5559,  8340,  11796, 1177,  5042,  8652,  10752, 6561,  10659, 1673,  2437,
    7443,  8653,  10276, 11935, 8747,  2399,  953,   1065,  9198,  8925,  3694,
    11272, 4821,  3247,  2842,  11287, 9970,  10123, 11029, 9888,  1,     5374,
    726,   5911,  10938, 2525,  2294,  2089,  6429,  5067,  9923,  4231,  2744,
    11745, 1326,  10593, 4134,  9893,  2768,  5542,  6461,  4989,  8577,  9048,
    8668,  6522,  1000,  3707,  949,   12280, 790,   5755,  8246,  12159, 1853,
    3932,  5777,  3584,  3553,  9005,  11077, 12171, 4896,  355,   2975,  11950,
    9275,  11955, 11567, 3296,  4255,  8830,  4591,  8011,  2747,  3289,  3504,
    3748,  81,    5179,  9650,  11809, 1170,  7901,  1479,  9452,  4611,  4890,
    4978,  10908, 1062,  5092,  9094,  10092, 3051,  2548,  3006,  6498,  7203,
    10861, 6553,  7837,  1635,  12144, 7266,  5331,  3135,  11560, 2545,  11462,
    4320,  1759,  2625,  11267, 955,   7657,  5146,  4354,  140,   2731,  3328,
    4177,  7484,  9408,  1646,  9813,  2963,  8907,  563,   2468,  3201,  9863,
    1305,  8340,  1177,  8652,  6561,  1673,  7443,  10276, 8747,  953,   9198,
    3694,  4821,  2842,  9970,  11029, 1,     726,   10938, 2294,  6429,  9923,
    2744,  1326,  4134,  2768,  6461,  8577,  8668,  1000,  949,   790,   8246,
    1853,  5777,  3553,  11077, 4896,  2975,  9275,  11567, 4255,  4591,  2747,
    3504,  81,    9650,  1170,  1479,  4611,  4978,  1062,  9094,  3051,  3006,
    7203,  6553,  1635,  7266,  3135,  2545,  4320,  2625,  955,   5146,  140,
    3328,  7484,  1646,  2963,  563,   3201,  1305,  1177,  6561,  7443,  8747,
    9198,  4821,  9970,  1,     10938, 6429,  2744,  4134,  6461,  8668,  949,
    8246,  5777,  11077, 2975,  11567, 4591,  3504,  9650,  1479,  4978,  9094,
    3006,  6553,  7266,  2545,  2625,  5146,  3328,  1646,  563,   1305,  6561,
    8747,  4821,  1,     6429,  4134,  8668,  8246,  11077, 11567, 3504,  1479,
    9094,  6553,  2545,  5146,  1646,  1305,  8747,  1,     4134,  8246,  11567,
    1479,  6553,  5146,  1305,  1,     8246,  1479,  5146,  1,     1479,  1};

const uint16_t harvey_omegas_inv_shoup[1023] = {
    5,     6687,  62997, 28035, 28659, 24659, 55339, 58640, 3871,  5428,  57621,
    37287, 31522, 11343, 2906,  40183, 58331, 9215,  21587, 4452,  13465, 43073,
    12916, 9625,  12233, 5599,  9476,  21592, 11140, 10927, 5572,  41575, 34285,
    2037,  64240, 13348, 27021, 3226,  48214, 37095, 52918, 37191, 42220, 57035,
    22563, 48609, 7679,  61680, 14633, 298,   46817, 54454, 62634, 32040, 4666,
    18819, 7071,  20206, 41873, 15566, 56491, 61339, 45388, 31688, 22046, 55286,
    57302, 29256, 52758, 33175, 52838, 2415,  14761, 29725, 51430, 6399,  29554,
    34039, 22094, 49937, 34455, 19427, 48545, 58501, 26605, 5892,  49606, 13049,
    45740, 14308, 51115, 5055,  48252, 18371, 35149, 36829, 46225, 33042, 16723,
    341,   34781, 34146, 24771, 64704, 5332,  2783,  17443, 51179, 19769, 17790,
    27112, 51377, 5060,  54939, 15833, 63184, 65488, 5348,  22846, 9828,  4212,
    40210, 26232, 62058, 30690, 16675, 5690,  57627, 43975, 28984, 39378, 31565,
    64842, 48134, 2319,  25459, 9881,  5551,  14825, 44439, 20968, 15140, 45782,
    2271,  30808, 32728, 15380, 19038, 19113, 47201, 11663, 10937, 18947, 36498,
    24819, 59355, 48022, 58491, 13230, 10969, 59072, 21267, 61957, 34701, 64906,
    62848, 37394, 34199, 26109, 39319, 23539, 27229, 1893,  14750, 16350, 56507,
    15865, 37772, 50257, 42487, 63728, 26712, 8569,  64373, 49462, 29096, 48742,
    43793, 63754, 60149, 61413, 7940,  61685, 21320, 63296, 9316,  17577, 21758,
    21843, 63306, 22691, 12500, 12292, 13625, 47089, 2298,  64245, 20035, 24483,
    31261, 11337, 61754, 42721, 30296, 46092, 62464, 14649, 20361, 39202, 7487,
    17539, 40482, 39612, 63669, 18686, 36493, 18131, 61893, 19987, 29832, 54107,
    21166, 431,   17395, 56528, 42615, 27619, 31325, 26051, 31293, 51462, 46524,
    14324, 5642,  62976, 1285,  38812, 43591, 6239,  25539, 44657, 33010, 42135,
    15572, 63178, 58800, 7887,  60347, 46705, 45089, 50406, 33127, 58187, 25261,
    24589, 33938, 26104, 32632, 26077, 64730, 38770, 55627, 26547, 63402, 11993,
    32344, 58171, 5199,  32205, 15369, 5663,  24190, 56667, 19881, 27155, 39340,
    50289, 17075, 48497, 63850, 49451, 15721, 53819, 53259, 6436,  10831, 16270,
    21731, 53942, 10463, 13588, 277,   20067, 64608, 16030, 48476, 37100, 59605,
    34653, 4719,  20158, 47222, 38412, 783,   15,    20062, 57920, 18569, 20441,
    8441,  34946, 44849, 11615, 16286, 41793, 46326, 29032, 34029, 8719,  55014,
    43921, 27645, 64762, 13358, 40396, 63685, 38748, 28877, 36701, 16798, 28429,
    64778, 33421, 32781, 16718, 59189, 37319, 6111,  61648, 40044, 15529, 9679,
    13572, 45750, 27683, 46038, 61125, 40034, 2154,  14756, 23038, 53968, 43900,
    895,   9380,  32290, 56832, 30584, 13998, 56459, 21214, 60619, 60085, 46700,
    38402, 52945, 5092,  29528, 602,   34786, 40834, 22232, 27203, 33991, 27443,
    7247,  44284, 23640, 23219, 19198, 23128, 36583, 746,   18739, 37831, 58283,
    14564, 44433, 14281, 17678, 17747, 39148, 6148,  42924, 22275, 15166, 13684,
    55115, 39911, 44951, 7604,  33591, 50171, 1023,  38807, 36903, 8777,  63040,
    15998, 8351,  52331, 22467, 59307, 53371, 15801, 23059, 15182, 33746, 47500,
    58480, 65392, 16046, 3002,  29485, 12638, 55094, 13161, 55104, 26536, 50027,
    17070, 41809, 853,   21416, 52598, 29160, 63456, 13332, 6959,  10841, 29645,
    16654, 44476, 2245,  62906, 45420, 6276,  6815,  26888, 32648, 46140, 57115,
    57339, 10532, 34989, 32813, 56843, 43959, 8921,  46993, 12996, 44401, 39692,
    32909, 46145, 63802, 54800, 38567, 63648, 57472, 46646, 37063, 12793, 52422,
    5082,  16153, 5679,  44252, 49052, 38450, 47596, 47782, 19699, 61925, 60112,
    14601, 25709, 62048, 17315, 21752, 15156, 309,   60192, 49377, 53169, 23822,
    53984, 63962, 58816, 27949, 52731, 65274, 5,     62997, 28659, 55339, 3871,
    57621, 31522, 2906,  58331, 21587, 13465, 12916, 12233, 9476,  11140, 5572,
    34285, 64240, 27021, 48214, 52918, 42220, 22563, 7679,  14633, 46817, 62634,
    4666,  7071,  41873, 56491, 45388, 22046, 57302, 52758, 52838, 14761, 51430,
    29554, 22094, 34455, 48545, 26605, 49606, 45740, 51115, 48252, 35149, 46225,
    16723, 34781, 24771, 5332,  17443, 19769, 27112, 5060,  15833, 65488, 22846,
    4212,  26232, 30690, 5690,  43975, 39378, 64842, 2319,  9881,  14825, 20968,
    45782, 30808, 15380, 19113, 11663, 18947, 24819, 48022, 13230, 59072, 61957,
    64906, 37394, 26109, 23539, 1893,  16350, 15865, 50257, 63728, 8569,  49462,
    48742, 63754, 61413, 61685, 63296, 17577, 21843, 22691, 12292, 47089, 64245,
    24483, 11337, 42721, 46092, 14649, 39202, 17539, 39612, 18686, 18131, 19987,
    54107, 431,   56528, 27619, 26051, 51462, 14324, 62976, 38812, 6239,  44657,
    42135, 63178, 7887,  46705, 50406, 58187, 24589, 26104, 26077, 38770, 26547,
    11993, 58171, 32205, 5663,  56667, 27155, 50289, 48497, 49451, 53819, 6436,
    16270, 53942, 13588, 20067, 16030, 37100, 34653, 20158, 38412, 15,    57920,
    20441, 34946, 11615, 41793, 29032, 8719,  43921, 64762, 40396, 38748, 36701,
    28429, 33421, 16718, 37319, 61648, 15529, 13572, 27683, 61125, 2154,  23038,
    43900, 9380,  56832, 13998, 21214, 60085, 38402, 5092,  602,   40834, 27203,
    27443, 44284, 23219, 23128, 746,   37831, 14564, 14281, 17747, 6148,  22275,
    13684, 39911, 7604,  50171, 38807, 8777,  15998, 52331, 59307, 15801, 15182,
    47500, 65392, 3002,  12638, 13161, 26536, 17070, 853,   52598, 63456, 6959,
    29645, 44476, 62906, 6276,  26888, 46140, 57339, 34989, 56843, 8921,  12996,
    39692, 46145, 54800, 63648, 46646, 12793, 5082,  5679,  49052, 47596, 19699,
    60112, 25709, 17315, 15156, 60192, 53169, 53984, 58816, 52731, 5,     28659,
    3871,  31522, 58331, 13465, 12233, 11140, 34285, 27021, 52918, 22563, 14633,
    62634, 7071,  56491, 22046, 52758, 14761, 29554, 34455, 26605, 45740, 48252,
    46225, 34781, 5332,  19769, 5060,  65488, 4212,  30690, 43975, 64842, 9881,
    20968, 30808, 19113, 18947, 48022, 59072, 64906, 26109, 1893,  15865, 63728,
    49462, 63754, 61685, 17577, 22691, 47089, 24483, 42721, 14649, 17539, 18686,
    19987, 431,   27619, 51462, 62976, 6239,  42135, 7887,  50406, 24589, 26077,
    26547, 58171, 5663,  27155, 48497, 53819, 16270, 13588, 16030, 34653, 38412,
    57920, 34946, 41793, 8719,  64762, 38748, 28429, 16718, 61648, 13572, 61125,
    23038, 9380,  13998, 60085, 5092,  40834, 27443, 23219, 746,   14564, 17747,
    22275, 39911, 50171, 8777,  52331, 15801, 47500, 3002,  13161, 17070, 52598,
    6959,  44476, 6276,  46140, 34989, 8921,  39692, 54800, 46646, 5082,  49052,
    19699, 25709, 15156, 53169, 58816, 5,     3871,  58331, 12233, 34285, 52918,
    14633, 7071,  22046, 14761, 34455, 45740, 46225, 5332,  5060,  4212,  43975,
    9881,  30808, 18947, 59072, 26109, 15865, 49462, 61685, 22691, 24483, 14649,
    18686, 431,   51462, 6239,  7887,  24589, 26547, 5663,  48497, 16270, 16030,
    38412, 34946, 8719,  38748, 16718, 13572, 23038, 13998, 5092,  27443, 746,
    17747, 39911, 8777,  15801, 3002,  17070, 6959,  6276,  34989, 39692, 46646,
    49052, 25709, 53169, 5,     58331, 34285, 14633, 22046, 34455, 46225, 5060,
    43975, 30808, 59072, 15865, 61685, 24483, 18686, 51462, 7887,  26547, 48497,
    16030, 34946, 38748, 13572, 13998, 27443, 17747, 8777,  3002,  6959,  34989,
    46646, 25709, 5,     34285, 22046, 46225, 43975, 59072, 61685, 18686, 7887,
    48497, 34946, 13572, 27443, 8777,  6959,  46646, 5,     22046, 43975, 61685,
    7887,  34946, 27443, 6959,  5,     43975, 7887,  27443, 5,     7887,  5};

const uint16_t harvey_psis[1024] = {
    1,     7,     49,    343,   2401,  4518,  7048,  180,   1260,  8820,  295,
    2065,  2166,  2873,  7822,  5598,  2319,  3944,  3030,  8921,  1002,  7014,
    12231, 11883, 9447,  4684,  8210,  8314,  9042,  1849,  654,   4578,  7468,
    3120,  9551,  5412,  1017,  7119,  677,   4739,  8595,  11009, 3329,  11014,
    3364,  11259, 5079,  10975, 3091,  9348,  3991,  3359,  11224, 4834,  9260,
    3375,  11336, 5618,  2459,  4924,  9890,  7785,  5339,  506,   3542,  216,
    1512,  10584, 354,   2478,  5057,  10821, 2013,  1802,  325,   2275,  3636,
    874,   6118,  5959,  4846,  9344,  3963,  3163,  9852,  7519,  3477,  12050,
    10616, 578,   4046,  3744,  1630,  11410, 6136,  6085,  5728,  3229,  10314,
    10753, 1537,  10759, 1579,  11053, 3637,  881,   6167,  6302,  7247,  1573,
    11011, 3343,  11112, 4050,  3772,  1826,  493,   3451,  11868, 9342,  3949,
    3065,  9166,  2717,  6730,  10243, 10256, 10347, 10984, 3154,  9789,  7078,
    390,   2730,  6821,  10880, 2426,  4693,  8273,  8755,  12129, 11169, 4449,
    6565,  9088,  2171,  2908,  8067,  7313,  2035,  1956,  1403,  9821,  7302,
    1958,  1417,  9919,  7988,  6760,  10453, 11726, 8348,  9280,  3515,  27,
    189,   1323,  9261,  3382,  11385, 5961,  4860,  9442,  4649,  7965,  6599,
    9326,  3837,  2281,  3678,  1168,  8176,  8076,  7376,  2476,  5043,  10723,
    1327,  9289,  3578,  468,   3276,  10643, 767,   5369,  716,   5012,  10506,
    12097, 10945, 2881,  7878,  5990,  5063,  10863, 2307,  3860,  2442,  4805,
    9057,  1954,  1389,  9723,  6616,  9445,  4670,  8112,  7628,  4240,  5102,
    11136, 4218,  4948,  10058, 8961,  1282,  8974,  1373,  9611,  5832,  3957,
    3121,  9558,  5461,  1360,  9520,  5195,  11787, 8775,  12269, 12149, 11309,
    5429,  1136,  7952,  6508,  8689,  11667, 7935,  6389,  7856,  5836,  3985,
    3317,  10930, 2776,  7143,  845,   5915,  4538,  7188,  1160,  8120,  7684,
    4632,  7846,  5766,  3495,  12176, 11498, 6752,  10397, 11334, 5604,  2361,
    4238,  5088,  11038, 3532,  146,   1022,  7154,  922,   6454,  8311,  9021,
    1702,  11914, 9664,  6203,  6554,  9011,  1632,  11424, 6234,  6771,  10530,
    12265, 12121, 11113, 4057,  3821,  2169,  2894,  7969,  6627,  9522,  5209,
    11885, 9461,  4782,  8896,  827,   5789,  3656,  1014,  7098,  530,   3710,
    1392,  9744,  6763,  10474, 11873, 9377,  4194,  4780,  8882,  729,   5103,
    11143, 4267,  5291,  170,   1190,  8330,  9154,  2633,  6142,  6127,  6022,
    5287,  142,   994,   6958,  11839, 9139,  2528,  5407,  982,   6874,  11251,
    5023,  10583, 347,   2429,  4714,  8420,  9784,  7043,  145,   1015,  7105,
    579,   4053,  3793,  1973,  1522,  10654, 844,   5908,  4489,  6845,  11048,
    3602,  636,   4452,  6586,  9235,  3200,  10111, 9332,  3879,  2575,  5736,
    3285,  10706, 1208,  8456,  10036, 8807,  204,   1428,  9996,  8527,  10533,
    12286, 12268, 12142, 11260, 5086,  11024, 3434,  11749, 8509,  10407, 11404,
    6094,  5791,  3670,  1112,  7784,  5332,  457,   3199,  10104, 9283,  3536,
    174,   1218,  8526,  10526, 12237, 11925, 9741,  6742,  10327, 10844, 2174,
    2929,  8214,  8342,  9238,  3221,  10258, 10361, 11082, 3840,  2302,  3825,
    2197,  3090,  9341,  3942,  3016,  8823,  316,   2212,  3195,  10076, 9087,
    2164,  2859,  7724,  4912,  9806,  7197,  1223,  8561,  10771, 1663,  11641,
    7753,  5115,  11227, 4855,  9407,  4404,  6250,  6883,  11314, 5464,  1381,
    9667,  6224,  6701,  10040, 8835,  400,   2800,  7311,  2021,  1858,  717,
    5019,  10555, 151,   1057,  7399,  2637,  6170,  6323,  7394,  2602,  5925,
    4608,  7678,  4590,  7552,  3708,  1378,  9646,  6077,  5672,  2837,  7570,
    3834,  2260,  3531,  139,   973,   6811,  10810, 1936,  1263,  8841,  442,
    3094,  9369,  4138,  4388,  6138,  6099,  5826,  3915,  2827,  7500,  3344,
    11119, 4099,  4115,  4227,  5011,  10499, 12048, 10602, 480,   3360,  11231,
    4883,  9603,  5776,  3565,  377,   2639,  6184,  6421,  8080,  7404,  2672,
    6415,  8038,  7110,  614,   4298,  5508,  1689,  11823, 9027,  1744,  12208,
    11722, 8320,  9084,  2143,  2712,  6695,  9998,  8541,  10631, 683,   4781,
    8889,  778,   5446,  1255,  8785,  50,    350,   2450,  4861,  9449,  4698,
    8308,  9000,  1555,  10885, 2461,  4938,  9988,  8471,  10141, 9542,  5349,
    576,   4032,  3646,  944,   6608,  9389,  4278,  5368,  709,   4963,  10163,
    9696,  6427,  8122,  7698,  4730,  8532,  10568, 242,   1694,  11858, 9272,
    3459,  11924, 9734,  6693,  9984,  8443,  9945,  8170,  8034,  7082,  418,
    2926,  8193,  8195,  8209,  8307,  8993,  1506,  10542, 60,    420,   2940,
    8291,  8881,  722,   5054,  10800, 1866,  773,   5411,  1010,  7070,  334,
    2338,  4077,  3961,  3149,  9754,  6833,  10964, 3014,  8809,  218,   1526,
    10682, 1040,  7280,  1804,  339,   2373,  4322,  5676,  2865,  7766,  5206,
    11864, 9314,  3753,  1693,  11851, 9223,  3116,  9523,  5216,  11934, 9804,
    7183,  1125,  7875,  5969,  4916,  9834,  7393,  2595,  5876,  4265,  5277,
    72,    504,   3528,  118,   826,   5782,  3607,  671,   4697,  8301,  8951,
    1212,  8484,  10232, 10179, 9808,  7211,  1321,  9247,  3284,  10699, 1159,
    8113,  7635,  4289,  5445,  1248,  8736,  11996, 10238, 10221, 10102, 9269,
    3438,  11777, 8705,  11779, 8719,  11877, 9405,  4390,  6152,  6197,  6512,
    8717,  11863, 9307,  3704,  1350,  9450,  4705,  8357,  9343,  3956,  3114,
    9509,  5118,  11248, 5002,  10436, 11607, 7515,  3449,  11854, 9244,  3263,
    10552, 130,   910,   6370,  7723,  4905,  9757,  6854,  11111, 4043,  3723,
    1483,  10381, 11222, 4820,  9162,  2689,  6534,  8871,  652,   4564,  7370,
    2434,  4749,  8665,  11499, 6759,  10446, 11677, 8005,  6879,  11286, 5268,
    9,     63,    441,   3087,  9320,  3795,  1987,  1620,  11340, 5646,  2655,
    6296,  7205,  1279,  8953,  1226,  8582,  10918, 2692,  6555,  9018,  1681,
    11767, 8635,  11289, 5289,  156,   1092,  7644,  4352,  5886,  4335,  5767,
    3502,  12225, 11841, 9153,  2626,  6093,  5784,  3621,  769,   5383,  814,
    5698,  3019,  8844,  463,   3241,  10398, 11341, 5653,  2704,  6639,  9606,
    5797,  3712,  1406,  9842,  7449,  2987,  8620,  11184, 4554,  7300,  1944,
    1319,  9233,  3186,  10013, 8646,  11366, 5828,  3929,  2925,  8186,  8146,
    7866,  5906,  4475,  6747,  10362, 11089, 3889,  2645,  6226,  6715,  10138,
    9521,  5202,  11836, 9118,  2381,  4378,  6068,  5609,  2396,  4483,  6803,
    10754, 1544,  10808, 1922,  1165,  8155,  7929,  6347,  7562,  3778,  1868,
    787,   5509,  1696,  11872, 9370,  4145,  4437,  6481,  8500,  10344, 10963,
    3007,  8760,  12164, 11414, 6164,  6281,  7100,  544,   3808,  2078,  2257,
    3510,  12281, 12233, 11897, 9545,  5370,  723,   5061,  10849, 2209,  3174,
    9929,  8058,  7250,  1594,  11158, 4372,  6026,  5315,  338,   2366,  4273,
    5333,  464,   3248,  10447, 11684, 8054,  7222,  1398,  9786,  7057,  243,
    1701,  11907, 9615,  5860,  4153,  4493,  6873,  11244, 4974,  10240, 10235,
    10200, 9955,  8240,  8524,  10512, 12139, 11239, 4939,  9995,  8520,  10484,
    11943, 9867,  7624,  4212,  4906,  9764,  6903,  11454, 6444,  8241,  8531,
    10561, 193,   1351,  9457,  4754,  8700,  11744, 8474,  10162, 9689,  6378,
    7779,  5297,  212,   1484,  10388, 11271, 5163,  11563, 7207,  1293,  9051,
    1912,  1095,  7665,  4499,  6915,  11538, 7032,  68,    476,   3332,  11035,
    3511};

const uint16_t harvey_psis_shoup[1024] = {
    5,     37,    261,   1829,  12804, 24094, 37586, 959,   6719,  47036, 1573,
    11012, 11551, 15321, 41713, 29853, 12366, 21032, 16158, 47574, 5343,  37404,
    65226, 63370, 50379, 24979, 43783, 44337, 48220, 9860,  3487,  24414, 39826,
    16638, 50934, 28861, 5423,  37964, 3610,  25272, 45836, 58709, 17753, 58736,
    17939, 60043, 27085, 58528, 16483, 49851, 21283, 17913, 59856, 25779, 49382,
    17998, 60453, 29960, 13113, 26259, 52742, 41516, 28472, 2698,  18889, 1151,
    8063,  56443, 1887,  13214, 26968, 57707, 10735, 9609,  1733,  12132, 19390,
    4660,  32626, 31778, 25843, 49830, 21134, 16867, 52539, 40098, 18542, 64261,
    56614, 3082,  21576, 19966, 8692,  60848, 32722, 32450, 30546, 17219, 55003,
    57344, 8196,  57376, 8420,  58944, 19395, 4698,  32887, 33607, 38647, 8388,
    58720, 17827, 59259, 21598, 20115, 9737,  2629,  18403, 63290, 49819, 21059,
    16345, 48881, 14489, 35890, 54624, 54694, 55179, 58576, 16819, 52203, 37746,
    2079,  14558, 36375, 58021, 12937, 25027, 44119, 46689, 64682, 59563, 23726,
    35010, 48465, 11577, 15508, 43020, 38999, 10852, 10431, 7482,  52374, 38940,
    10441, 7556,  52897, 42599, 36050, 55744, 62533, 44519, 49489, 18745, 143,
    1007,  7055,  49387, 18035, 60715, 31789, 25917, 50353, 24792, 42476, 35191,
    49734, 20462, 12164, 19614, 6228,  43601, 43068, 39335, 13204, 26893, 57184,
    7076,  49537, 19081, 2495,  17470, 56758, 4090,  28632, 3818,  26728, 56027,
    64512, 58368, 15364, 42012, 31944, 27000, 57931, 12302, 20584, 13022, 25624,
    48300, 10420, 7407,  51851, 35282, 50369, 24904, 43260, 40679, 22611, 27208,
    59387, 22494, 26387, 53638, 47788, 6836,  47857, 7322,  51254, 31101, 21102,
    16643, 50971, 29122, 7252,  50769, 27704, 62858, 46796, 65429, 64789, 60309,
    28952, 6058,  42407, 34706, 46337, 62218, 42316, 34071, 41895, 31122, 21251,
    17689, 58288, 14804, 38092, 4506,  31544, 24200, 38332, 6186,  43303, 40977,
    24701, 41841, 30749, 18638, 64933, 61317, 36007, 55446, 60443, 29885, 12590,
    22600, 27133, 58864, 18835, 778,   5450,  38151, 4916,  34418, 44321, 48108,
    9076,  63536, 51537, 33079, 34951, 48054, 8703,  60923, 33245, 36109, 56155,
    65408, 64640, 59264, 21635, 20377, 11567, 15433, 42497, 35341, 50779, 27779,
    63381, 50454, 25501, 47441, 4410,  30872, 19497, 5407,  37852, 2826,  19785,
    7423,  51963, 36066, 55856, 63317, 50006, 22366, 25491, 47366, 3887,  27213,
    59424, 22755, 28216, 906,   6346,  44423, 48817, 14041, 32754, 32674, 32114,
    28195, 757,   5300,  37106, 63136, 48737, 13481, 28834, 5236,  36658, 60000,
    26787, 56438, 1850,  12953, 25139, 44903, 52177, 37559, 773,   5412,  37890,
    3087,  21614, 20227, 10521, 8116,  56816, 4500,  31506, 23939, 36503, 58917,
    19209, 3391,  23742, 35122, 49249, 17065, 53920, 49766, 20686, 13732, 30589,
    17518, 57094, 6442,  45094, 53520, 46966, 1087,  7615,  53307, 45473, 56171,
    65520, 65424, 64752, 60048, 27123, 58789, 18313, 62656, 45377, 55499, 60816,
    32498, 30882, 19571, 5930,  41511, 28435, 2437,  17059, 53883, 49505, 18857,
    927,   6495,  45468, 56134, 65258, 63594, 51947, 35954, 55072, 57829, 11593,
    15620, 43804, 44487, 49265, 17177, 54704, 55254, 59099, 20478, 12276, 20398,
    11716, 16478, 49814, 21022, 16084, 47052, 1685,  11796, 17038, 53734, 48460,
    11540, 15246, 41191, 26195, 52294, 38380, 6522,  45654, 57440, 8868,  62080,
    41345, 27277, 59872, 25891, 50166, 23486, 33330, 36706, 60336, 29138, 7364,
    51553, 33191, 35735, 53542, 47116, 2133,  14932, 38988, 10777, 9908,  3823,
    26765, 56288, 805,   5636,  39458, 14062, 32903, 33719, 39431, 13876, 31597,
    24574, 40946, 24478, 40274, 19774, 7348,  51441, 32408, 30248, 15129, 40370,
    20446, 12052, 18830, 741,   5188,  36322, 57648, 10324, 6735,  47148, 2357,
    16499, 49963, 22067, 23400, 32733, 32525, 31069, 20878, 15076, 39996, 17833,
    59296, 21859, 21944, 22542, 26723, 55990, 64250, 56539, 2559,  17918, 59893,
    26040, 51211, 30802, 19011, 2010,  14073, 32978, 34242, 43089, 39484, 14249,
    34210, 42865, 37916, 3274,  22920, 29373, 9007,  63050, 48140, 9300,  65104,
    62512, 44369, 48444, 11428, 14462, 35703, 53318, 45548, 56694, 3642,  25496,
    47404, 4148,  29042, 6692,  46849, 266,   1866,  13065, 25923, 50390, 25053,
    44305, 47996, 8292,  58048, 13124, 26333, 53264, 45174, 54080, 50886, 28525,
    3071,  21502, 19443, 5034,  35239, 50070, 22814, 28627, 3781,  26467, 54198,
    51707, 34274, 43313, 41052, 25224, 45500, 56358, 1290,  9033,  63237, 49446,
    18446, 63589, 51910, 35693, 53243, 45025, 53035, 43569, 42844, 37767, 2229,
    15604, 43692, 43703, 43777, 44300, 47958, 8031,  56219, 319,   2239,  15678,
    44215, 47361, 3850,  26952, 57595, 9951,  4122,  28856, 5386,  37703, 1781,
    12468, 21742, 21123, 16793, 52017, 36439, 58469, 16073, 46977, 1162,  8138,
    56966, 5546,  38823, 9620,  1807,  12654, 23048, 30269, 15278, 41415, 27763,
    63269, 49670, 20014, 9028,  63200, 49185, 16617, 50785, 27816, 63642, 52283,
    38306, 5999,  41996, 31832, 26216, 52443, 39426, 13838, 31336, 22744, 28141,
    383,   2687,  18814, 629,   4404,  30834, 19235, 3578,  25048, 44268, 47734,
    6463,  45244, 54566, 54283, 52305, 38455, 7044,  49313, 17513, 57056, 6180,
    43265, 40716, 22872, 29037, 6655,  46588, 63973, 54598, 54507, 53872, 49430,
    18334, 62805, 46422, 62816, 46497, 63338, 50155, 23411, 32807, 33047, 34727,
    46486, 63264, 49633, 19753, 7199,  50395, 25091, 44567, 49825, 21096, 16606,
    50710, 27293, 59984, 26675, 55654, 61898, 40076, 18393, 63216, 49297, 17401,
    56272, 693,   4852,  33970, 41185, 26157, 52033, 36551, 59253, 21560, 19854,
    7908,  55360, 59845, 25704, 48860, 14340, 34845, 47308, 3477,  24339, 39303,
    12980, 25325, 46209, 61323, 36045, 55707, 62272, 42689, 36685, 60187, 28093,
    47,    335,   2351,  16462, 49702, 20238, 10596, 8639,  60475, 30109, 14158,
    33575, 38423, 6820,  47745, 6538,  45766, 58224, 14356, 34957, 48092, 8964,
    62752, 46049, 60203, 28205, 831,   5823,  40764, 23208, 31389, 23118, 30754,
    18675, 65194, 63146, 48812, 14004, 32493, 30845, 19310, 4100,  28706, 4340,
    30386, 16100, 47164, 2469,  17283, 55451, 60480, 30146, 14420, 35405, 51227,
    30914, 19795, 7498,  52486, 39724, 15929, 45969, 59643, 24286, 38930, 10367,
    7034,  49238, 16990, 53398, 46108, 60613, 31080, 20952, 15598, 43655, 43441,
    41948, 31496, 23864, 35981, 55259, 59136, 20739, 14105, 33202, 35810, 54064,
    50774, 27741, 63120, 48625, 12697, 23347, 32360, 29912, 12777, 23907, 36279,
    57349, 8233,  57637, 10249, 6212,  43489, 42284, 33847, 40327, 20147, 9961,
    4196,  29378, 9044,  63312, 49969, 22104, 23662, 34562, 45329, 55163, 58464,
    16036, 46716, 64869, 60869, 32871, 33495, 37863, 2901,  20307, 11081, 12036,
    18718, 65493, 65237, 63445, 50902, 28637, 3855,  26989, 57856, 11780, 16926,
    52950, 42972, 38663, 8500,  59504, 23315, 32136, 28344, 1802,  12617, 22787,
    28440, 2474,  17321, 55712, 62309, 42951, 38514, 7455,  52187, 37634, 1295,
    9071,  63498, 51275, 31250, 22147, 23960, 36653, 59963, 26525, 54608, 54582,
    54395, 53089, 43943, 45457, 56059, 64736, 59936, 26339, 53302, 45436, 55910,
    63690, 52619, 40658, 22462, 26163, 52070, 36813, 61083, 34365, 43948, 45494,
    56320, 1029,  7204,  50433, 25352, 46396, 62629, 45190, 54192, 51670, 34013,
    41484, 28248, 1130,  7914,  55398, 60107, 27533, 61664, 38434, 6895,  48268,
    10196, 5839,  40876, 23992, 36876, 61530, 37500, 362,   2538,  17769, 58848,
    18723};

const uint16_t harvey_psis_inv[1024] = {
    12277, 5265,  9530,  3117,  5712,  816,   10650, 3277,  9246,  4832,  5957,
    851,   10655, 10300, 3227,  461,   3577,  511,   73,    1766,  5519,  2544,
    2119,  7325,  2802,  5667,  11343, 3376,  5749,  6088,  7892,  2883,  3923,
    2316,  3842,  4060,  580,   3594,  2269,  9102,  6567,  9716,  1388,  5465,
    7803,  8137,  2918,  3928,  9339,  10112, 11978, 10489, 3254,  3976,  568,
    8859,  11799, 12219, 12279, 10532, 12038, 8742,  4760,  680,   8875,  4779,
    7705,  8123,  2916,  10950, 6831,  4487,  641,   10625, 5029,  2474,  2109,
    5568,  2551,  2120,  3814,  4056,  2335,  10867, 3308,  11006, 6839,  977,
    10673, 8547,  1221,  1930,  7298,  11576, 8676,  2995,  3939,  7585,  11617,
    12193, 5253,  2506,  358,   8829,  6528,  11466, 1638,  234,   1789,  10789,
    6808,  11506, 8666,  1238,  3688,  4038,  4088,  584,   1839,  7285,  8063,
    4663,  9444,  10127, 8469,  4721,  2430,  9125,  11837, 1691,  10775, 6806,
    6239,  6158,  7902,  4640,  4174,  5863,  11371, 3380,  3994,  11104, 6853,
    979,   3651,  11055, 6846,  978,   7162,  9801,  10178, 1454,  7230,  4544,
    9427,  8369,  11729, 12209, 10522, 10281, 8491,  1213,  5440,  9555,  1365,
    195,   3539,  11039, 1577,  5492,  11318, 5128,  11266, 3365,  7503,  4583,
    7677,  8119,  4671,  5934,  7870,  6391,  913,   1886,  2025,  5556,  7816,
    11650, 6931,  9768,  3151,  9228,  6585,  7963,  11671, 6934,  11524, 6913,
    11521, 5157,  7759,  2864,  9187,  3068,  5705,  815,   1872,  2023,  289,
    5308,  6025,  7883,  9904,  4926,  7726,  8126,  4672,  2423,  9124,  3059,
    437,   1818,  7282,  6307,  901,   7151,  11555, 8673,  1239,  177,   5292,
    756,   108,   1771,  253,   8814,  10037, 4945,  2462,  7374,  2809,  5668,
    7832,  4630,  2417,  5612,  7824,  8140,  4674,  7690,  11632, 8684,  11774,
    1682,  5507,  7809,  11649, 10442, 8514,  6483,  9704,  6653,  2706,  10920,
    1560,  3734,  2289,  327,   7069,  4521,  4157,  4105,  2342,  10868, 12086,
    12260, 3507,  501,   10605, 1515,  1972,  7304,  2799,  3911,  7581,  1083,
    7177,  6292,  4410,  630,   90,    3524,  2259,  7345,  6316,  6169,  6148,
    6145,  4389,  627,   10623, 12051, 12255, 8773,  6520,  2687,  3895,  2312,
    5597,  11333, 1619,  5498,  2541,  363,   3563,  509,   7095,  11547, 12183,
    3496,  2255,  9100,  1300,  7208,  8052,  6417,  7939,  9912,  1416,  5469,
    6048,  864,   1879,  2024,  9067,  6562,  2693,  7407,  9836,  10183, 8477,
    1211,  173,   7047,  8029,  1147,  3675,  525,   75,    7033,  8027,  8169,
    1167,  7189,  1027,  7169,  9802,  6667,  2708,  3898,  4068,  9359,  1337,
    191,   5294,  6023,  2616,  7396,  11590, 8678,  8262,  6447,  921,   10665,
    12057, 3478,  4008,  11106, 12120, 3487,  9276,  10103, 6710,  11492, 8664,
    8260,  1180,  10702, 5040,  720,   3614,  5783,  9604,  1372,  196,   28,
    4,     10534, 5016,  11250, 10385, 12017, 8739,  3004,  9207,  6582,  6207,
    7909,  4641,  663,   7117,  8039,  2904,  3926,  4072,  7604,  6353,  11441,
    3390,  5751,  11355, 10400, 8508,  2971,  2180,  2067,  5562,  11328, 6885,
    11517, 6912,  2743,  3903,  11091, 3340,  9255,  10100, 4954,  7730,  6371,
    9688,  1384,  7220,  2787,  9176,  4822,  4200,  600,   7108,  2771,  3907,
    9336,  8356,  8216,  8196,  4682,  4180,  9375,  6606,  7966,  1138,  10696,
    1528,  5485,  11317, 8639,  10012, 6697,  7979,  4651,  2420,  7368,  11586,
    10433, 3246,  7486,  2825,  10937, 3318,  474,   7090,  4524,  5913,  7867,
    4635,  9440,  11882, 3453,  5760,  4334,  9397,  3098,  10976, 1568,  224,
    32,    10538, 3261,  3977,  9346,  10113, 8467,  11743, 12211, 3500,  500,
    1827,  261,   5304,  7780,  2867,  10943, 6830,  7998,  11676, 1668,  5505,
    2542,  9141,  4817,  9466,  6619,  11479, 5151,  4247,  7629,  4601,  5924,
    6113,  6140,  9655,  6646,  2705,  2142,  306,   7066,  2765,  395,   1812,
    3770,  11072, 8604,  10007, 11963, 1709,  9022,  4800,  7708,  9879,  6678,
    954,   5403,  4283,  4123,  589,   8862,  1266,  3692,  2283,  9104,  11834,
    12224, 7013,  4513,  7667,  6362,  4420,  2387,  341,   7071,  9788,  6665,
    9730,  1390,  10732, 10311, 1473,  1966,  3792,  7564,  11614, 10437, 1491,
    213,   1786,  9033,  3046,  9213,  10094, 1442,  206,   1785,  255,   1792,
    256,   10570, 1510,  7238,  1034,  7170,  6291,  7921,  11665, 3422,  4000,
    2327,  2088,  5565,  795,   10647, 1521,  5484,  2539,  7385,  1055,  7173,
    8047,  11683, 1669,  1994,  3796,  5809,  4341,  9398,  11876, 12230, 10525,
    12037, 12253, 3506,  4012,  9351,  4847,  2448,  7372,  9831,  3160,  2207,
    5582,  2553,  7387,  6322,  9681,  1383,  10731, 1533,  219,   5298,  4268,
    7632,  6357,  9686,  8406,  4712,  9451,  10128, 4958,  5975,  11387, 8649,
    11769, 6948,  11526, 12180, 1740,  10782, 6807,  2728,  7412,  4570,  4164,
    4106,  11120, 12122, 8754,  11784, 3439,  5758,  11356, 6889,  9762,  11928,
    1704,  1999,  10819, 12079, 12259, 7018,  11536, 1648,  1991,  2040,  2047,
    2048,  10826, 12080, 8748,  8272,  8204,  1172,  1923,  7297,  2798,  7422,
    6327,  4415,  7653,  6360,  11442, 12168, 7005,  8023,  9924,  8440,  8228,
    2931,  7441,  1063,  3663,  5790,  9605,  10150, 1450,  8985,  11817, 10466,
    10273, 12001, 3470,  7518,  1074,  1909,  7295,  9820,  4914,  702,   5367,
    7789,  8135,  9940,  1420,  3714,  11064, 12114, 12264, 1752,  5517,  9566,
    11900, 1700,  3754,  5803,  829,   1874,  7290,  2797,  10933, 5073,  7747,
    8129,  6428,  6185,  11417, 1631,  233,   5300,  9535,  10140, 11982, 8734,
    8270,  2937,  10953, 8587,  8249,  2934,  9197,  4825,  5956,  4362,  9401,
    1343,  3703,  529,   10609, 12049, 6988,  6265,  895,   3639,  4031,  4087,
    4095,  585,   10617, 8539,  4731,  4187,  9376,  3095,  9220,  10095, 10220,
    1460,  10742, 12068, 1724,  5513,  11321, 6884,  2739,  5658,  6075,  4379,
    11159, 10372, 8504,  4726,  9453,  3106,  7466,  11600, 10435, 8513,  9994,
    8450,  9985,  3182,  10988, 8592,  2983,  9204,  4826,  2445,  5616,  6069,
    867,   3635,  5786,  11360, 5134,  2489,  10889, 12089, 1727,  7269,  2794,
    9177,  1311,  5454,  9557,  6632,  2703,  9164,  10087, 1441,  3717,  531,
    3587,  2268,  324,   5313,  759,   1864,  5533,  2546,  7386,  9833,  8427,
    4715,  11207, 1601,  7251,  4547,  11183, 12131, 1733,  10781, 10318, 1474,
    10744, 5046,  4232,  11138, 10369, 6748,  964,   7160,  4534,  7670,  8118,
    8182,  4680,  11202, 6867,  981,   8918,  1274,  182,   26,    7026,  8026,
    11680, 12202, 10521, 1503,  7237,  4545,  5916,  9623,  8397,  11733, 10454,
    3249,  9242,  6587,  941,   1890,  270,   10572, 6777,  9746,  6659,  6218,
    6155,  6146,  878,   1881,  7291,  11575, 12187, 1741,  7271,  8061,  11685,
    6936,  4502,  9421,  4857,  4205,  7623,  1089,  10689, 1527,  8996,  10063,
    11971, 10488, 6765,  2722,  3900,  9335,  11867, 6962,  11528, 5158,  4248,
    4118,  5855,  2592,  5637,  6072,  2623,  7397,  8079,  9932,  4930,  5971,
    853,   3633,  519,   8852,  11798, 3441,  11025, 1575,  225,   8810,  11792,
    12218, 3501,  9278,  3081,  9218,  4828,  7712,  8124,  11694, 12204, 3499,
    4011,  573,   3593,  5780,  7848,  9899,  10192, 1456,  208,   7052,  2763,
    7417,  11593, 10434, 12024, 8740,  11782, 10461, 3250,  5731,  7841,  9898,
    1414,  202,   3540,  7528,  2831,  2160,  10842, 5060,  4234,  4116,  588,
    84};

const uint16_t harvey_psis_inv_shoup[1024] = {
    65472, 28077, 50822, 16622, 30461, 4351,  56795, 17475, 49307, 25768, 31768,
    4538,  56822, 54928, 17209, 2458,  19075, 2725,  389,   9417,  29432, 13566,
    11300, 39063, 14942, 30221, 60491, 18003, 30658, 32466, 42087, 15374, 20920,
    12350, 20488, 21651, 3093,  19166, 12100, 48540, 35021, 51814, 7402,  29144,
    41612, 43393, 15561, 20947, 49803, 53926, 63877, 55936, 17353, 21203, 3029,
    47244, 62922, 65162, 65482, 56166, 64197, 46620, 25384, 3626,  47329, 25485,
    41089, 43319, 15550, 58395, 36429, 23928, 3418,  56662, 26819, 13193, 11247,
    29693, 13604, 11305, 20339, 21630, 12452, 57952, 17641, 58693, 36471, 5210,
    56918, 45580, 6511,  10292, 38919, 61733, 46268, 15972, 21006, 40450, 61952,
    65024, 28013, 13364, 1909,  47084, 34813, 61147, 8735,  1247,  9540,  57536,
    36306, 61360, 46214, 6602,  19667, 21534, 21800, 3114,  9807,  38850, 42999,
    24867, 50363, 54006, 45164, 25176, 12958, 48662, 63125, 9017,  57461, 36295,
    33271, 32839, 42140, 24744, 22259, 31266, 60640, 18025, 21299, 59216, 36546,
    5220,  19470, 58955, 36509, 5215,  38194, 52267, 54278, 7754,  38556, 24232,
    50273, 44631, 62549, 65109, 56112, 54827, 45281, 6468,  29010, 50955, 7279,
    1039,  18873, 58869, 8409,  29288, 60357, 27347, 60080, 17945, 40012, 24440,
    40940, 43297, 24909, 31645, 41969, 34082, 4868,  10057, 10799, 29629, 41681,
    62128, 36962, 52091, 16803, 49211, 35117, 42465, 62240, 36978, 61456, 36866,
    61440, 27501, 41377, 15273, 48993, 16361, 30424, 4346,  9983,  10788, 1541,
    28307, 32130, 42039, 52817, 26269, 41201, 43335, 24915, 12921, 48657, 16313,
    2330,  9695,  38834, 33634, 4804,  38135, 61621, 46252, 6607,  943,   28221,
    4031,  575,   9444,  1349,  47004, 53526, 26371, 13129, 39324, 14980, 30226,
    41767, 24691, 12889, 29928, 41724, 43409, 24925, 41009, 62032, 46310, 62789,
    8969,  29368, 41644, 62122, 55686, 45404, 34573, 51750, 35479, 14430, 58235,
    8319,  19913, 12207, 1743,  37698, 24110, 22168, 21891, 12489, 57957, 64453,
    65381, 18702, 2671,  56555, 8079,  10516, 38951, 14926, 20856, 40428, 5775,
    38274, 33554, 23518, 3359,  479,   18793, 12047, 39170, 33682, 32898, 32786,
    32770, 23406, 3343,  56651, 64266, 65354, 46785, 34770, 14329, 20771, 12329,
    29848, 60437, 8633,  29320, 13550, 1935,  19001, 2714,  37836, 61578, 64970,
    18643, 12025, 48529, 6932,  38439, 42940, 34221, 42337, 52859, 7551,  29165,
    32253, 4607,  10020, 10793, 48353, 34994, 14361, 39500, 52454, 54304, 45206,
    6458,  922,   37580, 42817, 6116,  19598, 2799,  399,   37506, 42807, 43564,
    6223,  38338, 5476,  38231, 52273, 35554, 14441, 20787, 21694, 49910, 7130,
    1018,  28232, 32120, 13950, 39442, 61808, 46278, 44060, 34381, 4911,  56875,
    64298, 18547, 21374, 59227, 64634, 18595, 49467, 53878, 35783, 61285, 46204,
    44049, 6292,  57072, 26877, 3839,  19273, 30840, 51217, 7316,  1045,  149,
    21,    56176, 26749, 59995, 55382, 64085, 46604, 16020, 49100, 35101, 33101,
    42177, 24749, 3535,  37954, 42871, 15486, 20936, 21715, 40551, 33879, 61013,
    18078, 30669, 60555, 55462, 45372, 15844, 11625, 11023, 29661, 60411, 36717,
    61419, 36861, 14628, 20814, 59147, 17811, 49355, 53862, 26419, 41223, 33975,
    51665, 7380,  38503, 14862, 48934, 25715, 22398, 3199,  37906, 14777, 20835,
    49787, 44561, 43815, 43708, 24968, 22291, 49995, 35229, 42481, 6068,  57040,
    8148,  29250, 60352, 46070, 53392, 35714, 42551, 24803, 12905, 39292, 61786,
    55638, 17310, 39922, 15065, 58325, 17694, 2527,  37810, 24126, 31533, 41953,
    24717, 50342, 63365, 18414, 30717, 23112, 50113, 16521, 58533, 8361,  1194,
    170,   56198, 17390, 21208, 49841, 53931, 45153, 62624, 65120, 18665, 2666,
    9743,  1391,  28285, 41489, 15289, 58357, 36423, 42652, 62266, 8895,  29357,
    13556, 48748, 25688, 50481, 35298, 61216, 27469, 22648, 40684, 24536, 31592,
    32600, 32744, 51489, 35442, 14425, 11423, 1631,  37682, 14745, 2106,  9663,
    20105, 59045, 45884, 53366, 63797, 9113,  48113, 25597, 41105, 52683, 35613,
    5087,  28813, 22840, 21987, 3141,  47260, 6751,  19689, 12175, 48550, 63109,
    65189, 37399, 24067, 40887, 33927, 23571, 12729, 1818,  37708, 52198, 35543,
    51889, 7412,  57232, 54987, 7855,  10484, 20222, 40338, 61936, 55659, 7951,
    1135,  9524,  48172, 16244, 49132, 53830, 7690,  1098,  9519,  1359,  9556,
    1365,  56368, 8052,  38599, 5514,  38236, 33549, 42241, 62208, 18249, 21331,
    12409, 11135, 29677, 4239,  56779, 8111,  29245, 13540, 39383, 5626,  38252,
    42913, 62304, 8900,  10633, 20243, 30978, 23150, 50118, 63333, 65221, 56128,
    64192, 65344, 18697, 21395, 49867, 25848, 13054, 39314, 52427, 16851, 11769,
    29768, 13614, 39394, 33714, 51627, 7375,  57227, 8175,  1167,  28253, 22760,
    40700, 33901, 51654, 44828, 25128, 50401, 54011, 26440, 31864, 60725, 46124,
    62762, 37052, 61466, 64954, 9279,  57499, 36301, 14548, 39527, 24371, 22206,
    21896, 59301, 64645, 46684, 62842, 18339, 30706, 60560, 36738, 52059, 63610,
    9087,  10660, 57696, 64416, 65376, 37426, 61520, 8788,  10617, 10879, 10916,
    10921, 57733, 64421, 46652, 44113, 43751, 6250,  10255, 38914, 14921, 39580,
    33741, 23544, 40812, 33917, 61019, 64890, 37356, 42785, 52923, 45009, 43879,
    15630, 39682, 5668,  19534, 30877, 51222, 54128, 7732,  47916, 63018, 55814,
    54784, 64000, 18505, 40092, 5727,  10180, 38903, 52369, 26205, 3743,  28621,
    41537, 43383, 53009, 7572,  19806, 59003, 64602, 65402, 9343,  29421, 51014,
    63461, 9065,  20019, 30946, 4420,  9993,  38876, 14916, 58304, 27053, 41313,
    43351, 34279, 32983, 60885, 8697,  1242,  28264, 50849, 54075, 63898, 46577,
    44103, 15662, 58411, 45793, 43991, 15646, 49046, 25731, 31762, 23262, 50134,
    7162,  19747, 2821,  56576, 64256, 37266, 33410, 4772,  19406, 21496, 21795,
    21838, 3119,  56619, 45537, 25229, 22328, 50001, 16505, 49169, 53835, 54502,
    7786,  57286, 64357, 9193,  29400, 60373, 36711, 14606, 30173, 32397, 23352,
    59509, 55312, 45350, 25203, 50411, 16563, 39815, 61861, 55648, 45398, 53296,
    45062, 53248, 16969, 58597, 45820, 15908, 49084, 25736, 13038, 29949, 32365,
    4623,  19385, 30856, 60581, 27379, 13273, 58069, 64469, 9209,  38764, 14900,
    48940, 6991,  29085, 50966, 35367, 14414, 48870, 53792, 7684,  19822, 2831,
    19129, 12095, 1727,  28333, 4047,  9940,  29506, 13577, 39388, 52438, 44940,
    25144, 59765, 8537,  38668, 24248, 59637, 64693, 9241,  57493, 55024, 7860,
    57296, 26909, 22568, 59397, 55296, 35986, 5140,  38183, 24179, 40903, 43292,
    43633, 24957, 59739, 36621, 5231,  47558, 6794,  970,   138,   37468, 42801,
    62288, 65072, 56107, 8015,  38594, 24238, 31549, 51318, 44780, 62570, 55750,
    17326, 49286, 35127, 5018,  10079, 1439,  56379, 36141, 51974, 35511, 33159,
    32823, 32775, 4682,  10031, 38882, 61728, 64992, 9284,  38775, 42988, 62314,
    36988, 24008, 50241, 25901, 22424, 40652, 5807,  57003, 8143,  47974, 53664,
    63840, 55931, 36077, 14516, 20798, 49782, 63285, 37127, 61477, 27507, 22654,
    21960, 31224, 13822, 30061, 32381, 13988, 39447, 43084, 52966, 26291, 31842,
    4548,  19374, 2767,  47206, 62917, 18350, 58795, 8399,  1199,  46982, 62885,
    65157, 18670, 49478, 16430, 49158, 25747, 41127, 43324, 62362, 65082, 18659,
    21390, 3055,  19161, 30824, 41852, 52790, 54352, 7764,  1109,  37607, 14734,
    39554, 61824, 55643, 64122, 46609, 62832, 55787, 17331, 30562, 41815, 52785,
    7540,  1077,  18878, 40146, 15097, 11519, 57819, 26984, 22579, 21950, 3135,
    447};
